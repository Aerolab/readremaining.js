!function(e,t,i,s){function o(t,i){this.element=t,this.settings=e.extend({},a,i),this._defaults=a,this._name=n,this.init()}var n="readRemaining",a={showGaugeDelay:1e3,showGaugeOnStart:!1,timeFormat:"%mm %ss left",maxTimeToShow:1200,minTimeToShow:10,gaugeContainer:"",insertPosition:"prepend",verboseMode:!1,gaugeWrapper:"",topOffset:0,bottomOffset:0};e.extend(o.prototype,{init:function(){var i=this;this.considerOnlyLast=60,this.pixelsMeasured=Array(),this.timesMeasured=0,this.endReached=!1,this.updateWithNextMeasurement=!1,this.scrollingElement=this.element,"body"==e(this.element).prop("tagName").toString().toLowerCase()&&(this.scrollingElement=t),this.currentScrollPos=e(this.scrollingElement).scrollTop(),this.startScrollPos4measure=this.currentScrollPos,""==this.settings.gaugeContainer&&(this.settings.gaugeContainer=e(this.element));var s=e(this.element).text().split(" ").length;this.scrolleableContentHeight=e(this.element)[0].scrollHeight;var o=Math.ceil(s/(200/60));o+=4*e(this.element).find("img").length;var n=s/this.scrolleableContentHeight,a=this.scrolleableContentHeight/o;this.averageScrollingSpeed=a,this.pixelsMeasured.push(a);for(var l=2;l<this.considerOnlyLast;l++)this.pixelsMeasured.push(a);this.measureLimit=650/60/n;var r='<div class="readRemainingGauge hidden" style="visibility:hidden;display:block;"></div>';if("prepend"==this.settings.insertPosition||""==insertPosition?this.settings.gaugeContainer.prepend(r):this.settings.gaugeContainer.append(r),this.gauge=e(i.settings.gaugeContainer).find(".readRemainingGauge"),this.gaugeInitialAbsoluteTop=this.gauge.offset().top-this.currentScrollPos,this.gauge.attr("style","").removeAttr("style"),this.pixelsLeftToRead=Math.round(this.scrolleableContentHeight-this.currentScrollPos),this.settings.verboseMode){console.log("Initial speed considering average words per minute: "+a.toFixed(2)+"px/s or "+(n*a).toFixed(2)+"w/s ("+s+" words in total)");var h=Math.round(this.pixelsLeftToRead/a);console.log("Total of pixels to scroll: "+this.pixelsLeftToRead+"px at "+a.toFixed(2)+"px/s = "+Math.floor(h/60)+"m "+h%60+"s\n\n")}this.updateTime(),this.updateGauge(),(this.settings.showGaugeOnStart||this.currentScrollPos>0)&&this.showGauge(),e(this.scrollingElement).scroll(function(){i.currentScrollPos=e(this).scrollTop(),i.pixelsLeftToRead=Math.round(i.scrolleableContentHeight-i.currentScrollPos),"undefined"==typeof i.lastScrollTop&&i.currentScrollPos>0||i.gauge.addClass("hidden"),"undefined"==typeof i.lastScrollTop&&(i.lastScrollTop=i.currentScrollPos),i.currentScrollPos+e(i.scrollingElement).height()==e(i.element)[0].scrollHeight&&(i.endReached=!0,i.gauge.addClass("hidden"),i.settings.verboseMode&&console.log("End of scroll reached. Estimated time to finish reading: "+i.timeLeftMinutes+"m "+i.timeLeftSeconds+"s. at "+i.averageScrollingSpeed.toFixed(2)+"px/s"),i.finishedReadingTO=setTimeout(function(){i.settings.verboseMode&&console.log("Estimated reading time reached.")},1e3*i.timeLeftTotalSeconds)),clearTimeout(i.readingTimeShowTO),i.currentScrollPos>i.lastScrollTop&&(i.settings.showGaugeDelay>0?i.readingTimeShowTO=setTimeout(function(){i.showGauge()},i.settings.showGaugeDelay):(i.updateGauge(),i.showGauge())),i.currentScrollPos==i.lastScrollTop&&(i.updateWithNextMeasurement=!0),i.lastScrollTop=i.currentScrollPos}),this.measureScrollSpeedInterval=setInterval(function(){if(i.currentScrollPos>=i.startScrollPos4measure){var s=e(t).scrollTop(),o=s+e(t).height(),n=e(i.element).offset().top,a=n+e(i.element).height(),l=i.currentScrollPos-i.startScrollPos4measure;if(0==l?i.scrollStill++:i.scrollStill=0,n>=s&&o>=n||s>=n&&a>=o||a>=s&&o>=a){i.pixelsMeasured.push(l),i.timesMeasured++;var r=0;if(e.each(i.pixelsMeasured,function(){r+=this}),i.averageScrollingSpeed=r/i.pixelsMeasured.length,i.averageScrollingSpeed<1&&(i.averageScrollingSpeed=1),i.averageScrollingSpeed>i.measureLimit&&(i.averageScrollingSpeed=i.measureLimit),i.settings.verboseMode){Math.round(i.pixelsLeftToRead/i.averageScrollingSpeed)}i.pixelsMeasured.length>=i.considerOnlyLast&&(i.pixelsMeasured.shift(),i.pixelsMeasured.shift(),i.pixelsMeasured.unshift(i.averageScrollingSpeed)),i.updateWithNextMeasurement&&(i.updateGauge(),i.updateWithNextMeasurement=!1)}i.startScrollPos4measure=e(i.element).scrollTop()}},1e3)},updateGauge:function(){this.settings.gaugeContainer.find(".readRemainingGauge").html(this.getRemainingTime({timeFormat:this.settings.timeFormat}))},showGauge:function(){var t=this,i=!1;""!=this.settings.gaugeWrapper?(this.settings.gaugeWrapper.each(function(){if(!i){var s=e(this)[0].scrollHeight,o=Math.round(e(this).offset().top);i=t.gaugeInitialAbsoluteTop+t.currentScrollPos>=o+t.settings.topOffset&&t.gaugeInitialAbsoluteTop+t.currentScrollPos+t.gauge.height()<o+s-t.settings.bottomOffset}}),i||t.gauge.addClass("hidden")):i=!0,this.updateTime(),i&&this.gauge.hasClass("hidden")&&!this.endReached&&this.timeLeftTotalSeconds<this.settings.maxTimeToShow&&this.timeLeftTotalSeconds>this.settings.minTimeToShow&&(this.updateGauge(),this.gauge.removeClass("hidden"))},updateTime:function(){this.timeLeftTotalSeconds=Math.round(this.pixelsLeftToRead/this.averageScrollingSpeed),this.timeLeftMinutes=Math.floor(this.timeLeftTotalSeconds/60),this.timeLeftSeconds=this.timeLeftTotalSeconds-60*this.timeLeftMinutes,this.timeLeftMinsFloat=1*(this.timeLeftMinutes+.0166667*this.timeLeftSeconds).toFixed(1),this.timeLeftTotalSeconds<=0&&this.gauge.addClass("hidden"),e(this.element).data("timeLeftMinutes",this.timeLeftMinutes),e(this.element).data("timeLeftSeconds",this.timeLeftSeconds)},getRemainingTime:function(t){var i="undefined"==typeof this.timeLeftMinutes?e(this).data("timeLeftMinutes"):this.timeLeftMinutes,s="undefined"==typeof this.timeLeftSeconds?e(this).data("timeLeftSeconds"):this.timeLeftSeconds,o=t.timeFormat.replace(/%m/g,i);return o=(" "+o).replace(" 0m ",""),o=o.replace(" 0s",""),o=o.replace(/%s/g,s),o=e.trim(o)}}),e.fn[n]=function(t){if("string"==typeof arguments[0]){var i,a=arguments[0],l=Array.prototype.slice.call(arguments,1);return this.each(function(){if(!e.data(this,"plugin_"+n)||"function"!=typeof e.data(this,"plugin_"+n)[a])throw new Error("Method "+a+" does not exist on jQuery."+n);i=e.data(this,"plugin_"+n)[a].apply(this,l)}),i!==s?i:this}return"object"!=typeof t&&t?this:this.each(function(){e.data(this,"plugin_"+n)||e.data(this,"plugin_"+n,new o(this,t))})}}(jQuery,window,document);